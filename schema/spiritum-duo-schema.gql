schema {
    query: Query
    mutation: Mutation
}

type Query {
    # Searches for patient by:
    # - hospitalNumber, 
    # - nationalNumber, 
    # - record ID, or 
    # - firstName, lastName, and dateOfBirth
    getPatient(id: ID, hospitalNumber: String, nationalNumber: String, firstName: String, lastName: String, dateOfBirth: String): Patient 

    getUser(id: ID!): User
    
    getDecisionPoint(id: ID!): DecisionPoint
    getDecisionPointsForPatient(patientId: ID!): [DecisionPoint!]

    getTestResult(id: ID!): TestResult
    getTestResultsForPatient(patientId: ID!): [TestResult!]

    getPatientPathways(patientId:ID!): [Pathway]
    getPathwayPatients(pathwayId:ID!): [Patient]
}

type Mutation {
    login(username: String!, password: String!): User
    addDecisionPoint(decisionPoint: DecisionPoint): DecisionPoint
    addPatient(patient: Patient!): Patient
}

scalar Date

type Pathway {
    id: ID!
    name: String!
}

type Patient {
	id: ID!
	hospitalNumber: String!
	nationalNumber: String!
	communicationMethod: String
	firstName: String!
	lastName: String!
    dateOfBirth: Date
}

type Role{
    id: ID
    name: String
}

type User {
    id: ID!
    firstName: String!
    lastName: String!
    userName: String!
    password: String
    department: String!
    lastAccess: Date!
    roles: [Role!]
}

type Configuration {
    hospitalNumberName: String!
    hospitalNumberRegex: String!
    nationalPatientNumberName: String!
    nationalPatientNumberRegex: String!
}

enum DecisionPointType {
        TRIAGE
        CLINIC
        MDT
        AD_HOC
        FOLLOW_UP
}

type DecisionPoint {
    id: ID!
    patient: Patient!
    addedAt: Date!
    updatedAt: Date
    clinician: User!
    decisionType: DecisionPointType!
    clinicHistory: String!
    comorbidities: String!
    requestsReferrals: String!
}

interface TestResult {
    id: ID!
    patient: Patient!
    addedAt: Date!
    description: String!
    mediaUrls: [String]
}